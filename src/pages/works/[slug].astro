---
import { getCollection, type CollectionEntry } from "astro:content";

type Illustrator = CollectionEntry<"illustrators">;

export async function getStaticPaths() {
  const illustrators = await getCollection("illustrators");

  return illustrators.map((item) => ({
    params: { slug: item.slug }, // ç”¨ Astro è‡ªå¸¶çš„ slug
    props: { item },
  }));
}

const { item } = Astro.props as { item: Illustrator };

// åˆ¤æ–·åœ–ç‰‡æ˜¯å¦ç‚ºç›´å‘ï¼ˆé«˜åº¦ >= å¯¬åº¦ï¼‰
const isPortrait = item.data.avatar.height >= item.data.avatar.width;

// âœ… åœ–ç‰‡é»æ“Šè¦é€£å»çš„ç¶²å€ï¼šå¾ md è£¡çš„ imageLink ä¾†
const linkTarget = item.data.imageLink ?? null;

// âœ… å–å¾— md æ­£æ–‡ï¼ˆå‚™è¨»ï¼‰ç”¨ä¾† render
const { Content } = await item.render();
---

<html lang="zh-Hant">
  <head>
    <meta charset="utf-8" />
    <title>{item.data.name} - ç¹ªå¸«è©³ç´°</title>
  </head>
  <body>
    <main>
      <a class="back-link" href="../">â† å›åˆ°ä½œå“ç€è¦½</a>

      <section class={`detail ${isPortrait ? "detail--portrait" : "detail--landscape"}`}>
        <!-- å·¦ï¼šå¤§åœ–ï¼ˆå¯ä»¥é»ï¼‰ -->
        <div class="image-wrapper">
          {linkTarget ? (
            <a href={linkTarget} target="_blank" rel="noopener noreferrer">
              <picture>
                <img src={item.data.avatar.src} alt={item.data.name} loading="lazy" />
              </picture>
            </a>
          ) : (
            <picture>
              <img src={item.data.avatar.src} alt={item.data.name} loading="lazy" />
            </picture>
          )}
        </div>

        <!-- å³ï¼šè³‡è¨Šæ¬„ -->
        <div class="meta">
          <h1 class="title">{item.data.name}</h1>

          <p class="status">
            {item.data.status === "commissioned" ? "ğŸŸ¢ å·²å§”è¨—" : "ğŸŸ¦ æƒ³å§”è¨—"}
          </p>

          {/* æ¨™ç±¤ */}
          {item.data.tags && (
            <div class="tags">
              {item.data.tags.map((tag) => (
                <span class="tag">{tag}</span>
              ))}
            </div>
          )}

          {/* æŒ‰éˆ• */}
          {item.data.links && (
            <div class="links">
              {item.data.links.twitter && (
                <a class="pixiv-btn" href={item.data.links.twitter} target="_blank">Twitter</a>
              )}
              {item.data.links.pixiv && (
                <a class="pixiv-btn" href={item.data.links.pixiv} target="_blank">Pixiv</a>
              )}
              {item.data.links.skeb && (
                <a class="pixiv-btn" href={item.data.links.skeb} target="_blank">Skeb</a>
              )}
              {item.data.links.website && (
                <a class="pixiv-btn" href={item.data.links.website} target="_blank">Website</a>
              )}
            </div>
          )}

          {/* å‚™è¨»æ–‡å­—ï¼ˆmd æ­£æ–‡ï¼‰ */}
          <article class="description">
            <Content />
          </article>
        </div>
      </section>
    </main>

    <style>
      /* èƒŒæ™¯ & Layout */
      body {
        background: #f6f7f9;
      }

      main {
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem 1rem 4rem;
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          "Noto Sans TC", sans-serif;
      }

      .back-link {
        color: #0096fa;
        font-size: 0.95rem;
        text-decoration: none;
        margin-bottom: 1rem;
        display: inline-block;
      }

      /* è©³ç´°é å¡ç‰‡ï¼šå…±åŒæ¨£å¼ */
      .detail {
        display: grid;
        gap: 2rem;
        margin-top: 1.5rem;
        background: #fff;
        border-radius: 1rem;
        padding: 2rem;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
      }
      
      /* ç›´åœ–ï¼šç¶­æŒå·¦å³å…©æ¬„ï¼ˆå·¦åœ–å³æ–‡å­—ï¼‰ */
      .detail--portrait {
        grid-template-columns: 2fr 1.3fr;
      }
      
      /* æ©«åœ–ï¼šæ”¹æˆä¸€æ¬„ï¼Œåœ–ç‰‡åœ¨ä¸Šã€æ–‡å­—åœ¨ä¸‹ */
      .detail--landscape {
        grid-template-columns: 1fr;
      }
      
      /* æ‰‹æ©Ÿç‰ˆä¸€å¾‹ä¸€æ¬„ */
      @media (max-width: 900px) {
        .detail {
          grid-template-columns: 1fr;
        }
      }


      @media (max-width: 900px) {
        .detail {
          grid-template-columns: 1fr;
        }
      }

      /* åœ–ç‰‡è¶…é€£çµ */
      .image-wrapper a {
        display: block;
        text-decoration: none;
      }

      /* åœ–ç‰‡å€ */
      .image-wrapper picture {
        display: block;
        width: 100%;
        overflow: hidden;
        border-radius: 1rem;
        background: #eee;
      }
      
      .image-wrapper picture img {
        width: 100%;
        height: auto;   /* ç¶­æŒåŸæœ¬æ¯”ä¾‹ç¸®æ”¾ */
        display: block;
      }



      /* æ¨™é¡Œ */
      .meta .title {
        font-size: 1.8rem;
        font-weight: 600;
        margin-bottom: 0.5rem;
      }

      .status {
        font-size: 1rem;
        color: #555;
        margin-bottom: 1rem;
      }

      .tags {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        margin-bottom: 1.2rem;
      }

      .tag {
        background: #eef6ff;
        border: 1px solid #cfe5ff;
        padding: 0.2rem 0.6rem;
        border-radius: 0.5rem;
        font-size: 0.85rem;
        color: #1877ff;
      }

      /* æŒ‰éˆ• */
      .links {
        display: flex;
        gap: 0.5rem;
        margin-bottom: 1rem;
      }

      .pixiv-btn {
        background: #0096fa;
        color: white;
        padding: 0.45rem 1rem;
        border-radius: 0.5rem;
        text-decoration: none;
        font-size: 0.9rem;
        font-weight: 500;
      }

      .pixiv-btn:hover {
        background: #007cdc;
      }

      /* å‚™è¨»ï¼ˆmd æ­£æ–‡ï¼‰ */
      .description {
        margin-top: 1rem;
        line-height: 1.6;
        color: #444;
        font-size: 0.95rem;
      }
    </style>
  </body>
</html>
